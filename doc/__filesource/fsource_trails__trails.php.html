<html>
<head>
<title>File Source for trails.php</title>
<link rel="stylesheet" type="text/css" href="../media/style.css">
</head>
<body>

<table border="0" cellspacing="0" cellpadding="0" height="48" width="100%">
  <tr>
    <td class="header_top">trails</td>
  </tr>
  <tr><td class="header_line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
  <tr>
    <td class="header_menu">
        
                                    
                              		  [ <a href="../classtrees_trails.html" class="menu">class tree: trails</a> ]
		  [ <a href="../elementindex_trails.html" class="menu">index: trails</a> ]
		  	    [ <a href="../elementindex.html" class="menu">all elements</a> ]
    </td>
  </tr>
  <tr><td class="header_line"><img src="../media/empty.png" width="1" height="1" border="0" alt=""  /></td></tr>
</table>

<table width="100%" border="0" cellpadding="0" cellspacing="0">
  <tr valign="top">
    <td width="200" class="menu">
      <b>Packages:</b><br />
              <a href="../li_trails.html">trails</a><br />
            <br /><br />
                  
      
                </td>
    <td>
      <table cellpadding="10" cellspacing="0" width="100%" border="0"><tr><td valign="top">

<h1 align="center">Source for file trails.php</h1>
<p>Documentation is available at <a href="../trails/_trails.php.html">trails.php</a></p>
<div class="src-code">
<ol><li><div class="src-line"><a name="a1"></a><span class="src-php">&lt;?php</span></div></li>
<li><div class="src-line"><a name="a2"></a>&nbsp;<a href="http://www.php.net/define">define</a><span class="src-sym">(</span><span class="src-str">'TRAILS_VERSION'</span><span class="src-sym">,</span><span class="src-str">'0.5.4'</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">class&nbsp;</span><a href="../trails/Trails_Dispatcher.html">Trails_Dispatcher</a><span class="src-sym">{</span><span class="src-key">public</span><a href="../trails/Trails_Dispatcher.html#var$trails_root">$trails_root</a><span class="src-sym">;</span><span class="src-key">public</span><a href="../trails/Trails_Dispatcher.html#var$trails_uri">$trails_uri</a><span class="src-sym">;</span><span class="src-key">public</span><a href="../trails/Trails_Dispatcher.html#var$default_controller">$default_controller</a><span class="src-sym">;</span><span class="src-key">function&nbsp;</span><a href="../trails/Trails_Dispatcher.html#method__construct">__construct</a><span class="src-sym">(</span><span class="src-var">$trails_root</span><span class="src-sym">,</span><span class="src-var">$trails_uri</span><span class="src-sym">,</span><span class="src-var">$default_controller</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#var$trails_root">trails_root</a>=<span class="src-var">$trails_root</span><span class="src-sym">;</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#var$trails_uri">trails_uri</a>=<span class="src-var">$trails_uri</span><span class="src-sym">;</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#var$default_controller">default_controller</a>=<span class="src-var">$default_controller</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function&nbsp;</span><a href="../trails/Trails_Dispatcher.html#methoddispatch">dispatch</a><span class="src-sym">(</span><span class="src-var">$uri</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$old_handler</span>=<a href="http://www.php.net/set_error_handler">set_error_handler</a><span class="src-sym">(</span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'Trails_Exception'</span><span class="src-sym">,</span><span class="src-str">'errorHandlerCallback'</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-id">E_ALL</span><span class="src-sym">)</span><span class="src-sym">;</span><a href="http://www.php.net/ob_start">ob_start</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$level</span>=<a href="http://www.php.net/ob_get_level">ob_get_level</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#methodmap_uri_to_response">map_uri_to_response</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#methodclean_uri">clean_uri</a><span class="src-sym">(</span>(string)<span class="src-var">$uri</span><span class="src-sym">))</span><span class="src-sym">-&gt;</span><span class="src-id">output</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">while</span><span class="src-sym">(</span><a href="http://www.php.net/ob_get_level">ob_get_level</a><span class="src-sym">(</span><span class="src-sym">)</span>&gt;=<span class="src-var">$level</span><span class="src-sym">)</span><span class="src-sym">{</span><a href="http://www.php.net/ob_end_flush">ob_end_flush</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">if</span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$old_handler</span><span class="src-sym">))</span><span class="src-sym">{</span><a href="http://www.php.net/set_error_handler">set_error_handler</a><span class="src-sym">(</span><span class="src-var">$old_handler</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}}</span><span class="src-key">function&nbsp;</span><a href="../trails/Trails_Dispatcher.html#methodmap_uri_to_response">map_uri_to_response</a><span class="src-sym">(</span><span class="src-var">$uri</span><span class="src-sym">)</span><span class="src-sym">{</span>try<span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-str">''</span>===<span class="src-var">$uri</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#var$default_controller">default_controller</a>.<span class="src-str">'.php'</span><span class="src-sym">))</span><span class="src-sym">{</span>throw&nbsp;<span class="src-key">new&nbsp;</span><span class="src-id"><a href="../trails/Trails_Exception.html">Trails_Exception</a></span><span class="src-sym">(</span><span class="src-num">404</span><span class="src-sym">,</span><a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><span class="src-str">'Default&nbsp;controller&nbsp;&quot;%s&quot;&nbsp;not&nbsp;found'</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#var$default_controller">default_controller</a><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-var">$controller_path</span>=<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#var$default_controller">default_controller</a><span class="src-sym">;</span><span class="src-var">$unconsumed</span>=<span class="src-var">$uri</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">else</span><span class="src-sym">{</span>list<span class="src-sym">(</span><span class="src-var">$controller_path</span><span class="src-sym">,</span><span class="src-var">$unconsumed</span><span class="src-sym">)</span>=<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#methodparse">parse</a><span class="src-sym">(</span><span class="src-var">$uri</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-var">$class</span>=<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#methodload_controller">load_controller</a><span class="src-sym">(</span><span class="src-var">$controller_path</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$controller</span>=<span class="src-key">new</span><span class="src-var">$class</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$response</span>=<span class="src-var">$controller</span><span class="src-sym">-&gt;</span><span class="src-id">perform</span><span class="src-sym">(</span><span class="src-var">$unconsumed</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span>catch<span class="src-sym">(</span><span class="src-id">Exception</span><span class="src-var">$e</span><span class="src-sym">)</span><span class="src-sym">{</span><a href="http://www.php.net/ob_clean">ob_clean</a><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$body</span>=<a href="http://www.php.net/sprintf">sprintf</a><span class="src-sym">(</span><span class="src-str">'&lt;html&gt;&lt;head&gt;&lt;title&gt;Trails&nbsp;Error&lt;/title&gt;&lt;/head&gt;'</span>.<span class="src-str">'&lt;body&gt;&lt;h1&gt;%s&lt;/h1&gt;&lt;pre&gt;%s&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;'</span><span class="src-sym">,</span><a href="http://www.php.net/htmlentities">htmlentities</a><span class="src-sym">(</span><span class="src-var">$e</span><span class="src-sym">-&gt;</span><span class="src-id">__toString</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">,</span><a href="http://www.php.net/htmlentities">htmlentities</a><span class="src-sym">(</span><span class="src-var">$e</span><span class="src-sym">-&gt;</span><span class="src-id">getTraceAsString</span><span class="src-sym">(</span><span class="src-sym">)))</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$e&nbsp;</span>instanceof&nbsp;<span class="src-id"><a href="../trails/Trails_Exception.html">Trails_Exception</a></span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$response</span>=<span class="src-key">new&nbsp;</span><span class="src-id"><a href="../trails/Trails_Response.html">Trails_Response</a></span><span class="src-sym">(</span><span class="src-var">$body</span><span class="src-sym">,</span><span class="src-var">$e</span><span class="src-sym">-&gt;</span><span class="src-id">headers</span><span class="src-sym">,</span><span class="src-var">$e</span><span class="src-sym">-&gt;</span><span class="src-id">getCode</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$e</span><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">else</span><span class="src-sym">{</span><span class="src-var">$response</span>=<span class="src-key">new&nbsp;</span><span class="src-id"><a href="../trails/Trails_Response.html">Trails_Response</a></span><span class="src-sym">(</span><span class="src-var">$body</span><span class="src-sym">,</span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-num">500</span><span class="src-sym">,</span><span class="src-var">$e</span><span class="src-sym">-&gt;</span><span class="src-id">getMessage</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-sym">}}</span><span class="src-key">return</span><span class="src-var">$response</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function&nbsp;</span><a href="../trails/Trails_Dispatcher.html#methodclean_uri">clean_uri</a><span class="src-sym">(</span><span class="src-var">$uri</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-id">FALSE</span>!==<span class="src-sym">(</span><span class="src-var">$pos</span>=<a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$uri</span><span class="src-sym">,</span><span class="src-str">'?'</span><span class="src-sym">)))</span><span class="src-sym">{</span><span class="src-var">$uri</span>=<a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$uri</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-var">$pos</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">return&nbsp;</span><a href="http://www.php.net/ltrim">ltrim</a><span class="src-sym">(</span><span class="src-var">$uri</span><span class="src-sym">,</span><span class="src-str">'/'</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function&nbsp;</span><a href="../trails/Trails_Dispatcher.html#methodparse">parse</a><span class="src-sym">(</span><span class="src-var">$unconsumed</span><span class="src-sym">,</span><span class="src-var">$controller</span>=<span class="src-id">NULL</span><span class="src-sym">)</span><span class="src-sym">{</span>list<span class="src-sym">(</span><span class="src-var">$head</span><span class="src-sym">,</span><span class="src-var">$tail</span><span class="src-sym">)</span>=<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#methodsplit_on_first_slash">split_on_first_slash</a><span class="src-sym">(</span><span class="src-var">$unconsumed</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><a href="http://www.php.net/preg_match">preg_match</a><span class="src-sym">(</span><span class="src-str">'/^\w+$/'</span><span class="src-sym">,</span><span class="src-var">$head</span><span class="src-sym">))</span><span class="src-sym">{</span>throw&nbsp;<span class="src-key">new&nbsp;</span><span class="src-id"><a href="../trails/Trails_Exception.html">Trails_Exception</a></span><span class="src-sym">(</span><span class="src-num">400</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-var">$controller</span>=<span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$controller</span><span class="src-sym">)</span>?<span class="src-var">$controller</span>.<span class="src-str">'/'</span>:<span class="src-str">''</span><span class="src-sym">)</span>.<span class="src-var">$head</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$controller</span>.<span class="src-str">'.php'</span><span class="src-sym">))</span><span class="src-sym">{</span><span class="src-key">return&nbsp;</span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$controller</span><span class="src-sym">,</span><span class="src-var">$tail</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">else&nbsp;</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$controller</span><span class="src-sym">))</span><span class="src-sym">{</span><span class="src-key">return</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#methodparse">parse</a><span class="src-sym">(</span><span class="src-var">$tail</span><span class="src-sym">,</span><span class="src-var">$controller</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span>throw&nbsp;<span class="src-key">new&nbsp;</span><span class="src-id"><a href="../trails/Trails_Exception.html">Trails_Exception</a></span><span class="src-sym">(</span><span class="src-num">404</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function&nbsp;</span><a href="../trails/Trails_Dispatcher.html#methodsplit_on_first_slash">split_on_first_slash</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$pos</span>=<a href="http://www.php.net/strpos">strpos</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">,</span><span class="src-str">'/'</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$pos</span>!==<span class="src-id">FALSE</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">return&nbsp;</span><span class="src-key">array</span><span class="src-sym">(</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-var">$pos</span><span class="src-sym">)</span><span class="src-sym">,</span><a href="http://www.php.net/substr">substr</a><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">,</span><span class="src-var">$pos</span>+<span class="src-num">1</span><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">return&nbsp;</span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$str</span><span class="src-sym">,</span><span class="src-str">''</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function&nbsp;</span><a href="../trails/Trails_Dispatcher.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-var">$path</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">return&nbsp;</span><a href="../trails/Trails_Dispatcher.html#methodfile_exists">file_exists</a><span class="src-sym">(</span><span class="src-str">&quot;</span>{<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#var$trails_root">trails_root</a><span class="src-sym">}</span>/controllers/<span class="src-var">$path<span class="src-str"></span><span class="src-str">"</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">load_controller</span><span class="src-sym">(</span><span class="src-var">$controller</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-inc">require_once</span><span class="src-str">"</span></span>{<span class="src-var">$this</span><span class="src-sym">-&gt;</span><a href="../trails/Trails_Dispatcher.html#var$trails_root">trails_root</a><span class="src-sym">}</span>/controllers/{<span class="src-var">$controller<span class="src-str"></span><span class="src-sym">}</span>.php<span class="src-str">"</span><span class="src-sym">;</span><span class="src-var">$class</span>=<span class="src-id">Trails_Inflector</span><span class="src-sym">::</span><span class="src-id">camelize</span><span class="src-sym">(</span><span class="src-var">$controller</span><span class="src-sym">)</span>.<span class="src-str">'Controller'</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">class_exists</span><span class="src-sym">(</span><span class="src-var">$class</span><span class="src-sym">))</span><span class="src-sym">{</span>throw&nbsp;<span class="src-key">new</span>&nbsp;<span class="src-id">Trails_Exception</span><span class="src-sym">(</span><span class="src-num">501</span><span class="src-sym">,</span><span class="src-str">'Controller&nbsp;missing:&nbsp;'</span>.<span class="src-var">$class</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">return</span><span class="src-var">$class</span><span class="src-sym">;</span><span class="src-sym">}}</span><span class="src-key">class</span>&nbsp;<span class="src-id">Trails_Response</span><span class="src-sym">{</span><span class="src-key">public</span><span class="src-var">$body</span>=<span class="src-str">''</span><span class="src-sym">,</span><span class="src-var">$status</span><span class="src-sym">,</span><span class="src-var">$reason</span><span class="src-sym">,</span><span class="src-var">$headers</span>=<span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">function</span>&nbsp;<span class="src-id">__construct</span><span class="src-sym">(</span><span class="src-var">$body</span>=<span class="src-str">''</span><span class="src-sym">,</span><span class="src-var">$headers</span>=<span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$status</span>=<span class="src-id">NULL</span><span class="src-sym">,</span><span class="src-var">$reason</span>=<span class="src-id">NULL</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">set_body</span><span class="src-sym">(</span><span class="src-var">$body</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">headers</span>=<span class="src-var">$headers</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$status</span><span class="src-sym">))<span class="src-str"></span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">set_status</span><span class="src-sym">(</span><span class="src-var">$status</span><span class="src-sym">,</span><span class="src-var">$reason</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}}</span><span class="src-key">function</span>&nbsp;<span class="src-id">set_body</span><span class="src-sym">(</span><span class="src-var">$body</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">body</span>=<span class="src-var">$body</span><span class="src-sym">;</span><span class="src-key">return</span><span class="src-var">$this</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">set_status</span><span class="src-sym">(</span><span class="src-var">$status</span><span class="src-sym">,</span><span class="src-var">$reason</span>=<span class="src-id">NULL</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">status</span>=<span class="src-var">$status</span><span class="src-sym">;</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">reason</span>=isset<span class="src-sym">(</span><span class="src-var">$reason</span><span class="src-sym">)</span>?<span class="src-var">$reason</span>:<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">get_reason</span><span class="src-sym">(</span><span class="src-var">$status</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">return</span><span class="src-var">$this</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">get_reason</span><span class="src-sym">(</span><span class="src-var">$status</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$reason</span>=<span class="src-key">array</span><span class="src-sym">(</span><span class="src-num">100</span>=&gt;<span class="src-str">'Continue'</span><span class="src-sym">,</span><span class="src-str">'Switching&nbsp;Protocols'</span><span class="src-sym">,</span><span class="src-num">200</span>=&gt;<span class="src-str">'OK'</span><span class="src-sym">,</span><span class="src-str">'Created'</span><span class="src-sym">,</span><span class="src-str">'Accepted'</span><span class="src-sym">,</span><span class="src-str">'Non-Authoritative&nbsp;Information'</span><span class="src-sym">,</span><span class="src-str">'No&nbsp;Content'</span><span class="src-sym">,</span><span class="src-str">'Reset&nbsp;Content'</span><span class="src-sym">,</span><span class="src-str">'Partial&nbsp;Content'</span><span class="src-sym">,</span><span class="src-num">300</span>=&gt;<span class="src-str">'Multiple&nbsp;Choices'</span><span class="src-sym">,</span><span class="src-str">'Moved&nbsp;Permanently'</span><span class="src-sym">,</span><span class="src-str">'Found'</span><span class="src-sym">,</span><span class="src-str">'See&nbsp;Other'</span><span class="src-sym">,</span><span class="src-str">'Not&nbsp;Modified'</span><span class="src-sym">,</span><span class="src-str">'Use&nbsp;Proxy'</span><span class="src-sym">,</span><span class="src-str">'(Unused)'</span><span class="src-sym">,</span><span class="src-str">'Temporary&nbsp;Redirect'</span><span class="src-sym">,</span><span class="src-num">400</span>=&gt;<span class="src-str">'Bad&nbsp;Request'</span><span class="src-sym">,</span><span class="src-str">'Unauthorized'</span><span class="src-sym">,</span><span class="src-str">'Payment&nbsp;Required'</span><span class="src-sym">,</span><span class="src-str">'Forbidden'</span><span class="src-sym">,</span><span class="src-str">'Not&nbsp;Found'</span><span class="src-sym">,</span><span class="src-str">'Method&nbsp;Not&nbsp;Allowed'</span><span class="src-sym">,</span><span class="src-str">'Not&nbsp;Acceptable'</span><span class="src-sym">,</span><span class="src-str">'Proxy&nbsp;Authentication&nbsp;Required'</span><span class="src-sym">,</span><span class="src-str">'Request&nbsp;Timeout'</span><span class="src-sym">,</span><span class="src-str">'Conflict'</span><span class="src-sym">,</span><span class="src-str">'Gone'</span><span class="src-sym">,</span><span class="src-str">'Length&nbsp;Required'</span><span class="src-sym">,</span><span class="src-str">'Precondition&nbsp;Failed'</span><span class="src-sym">,</span><span class="src-str">'Request&nbsp;Entity&nbsp;Too&nbsp;Large'</span><span class="src-sym">,</span><span class="src-str">'Request-URI&nbsp;Too&nbsp;Long'</span><span class="src-sym">,</span><span class="src-str">'Unsupported&nbsp;Media&nbsp;Type'</span><span class="src-sym">,</span><span class="src-str">'Requested&nbsp;Range&nbsp;Not&nbsp;Satisfiable'</span><span class="src-sym">,</span><span class="src-str">'Expectation&nbsp;Failed'</span><span class="src-sym">,</span><span class="src-num">500</span>=&gt;<span class="src-str">'Internal&nbsp;Server&nbsp;Error'</span><span class="src-sym">,</span><span class="src-str">'Not&nbsp;Implemented'</span><span class="src-sym">,</span><span class="src-str">'Bad&nbsp;Gateway'</span><span class="src-sym">,</span><span class="src-str">'Service&nbsp;Unavailable'</span><span class="src-sym">,</span><span class="src-str">'Gateway&nbsp;Timeout'</span><span class="src-sym">,</span><span class="src-str">'HTTP&nbsp;Version&nbsp;Not&nbsp;Supported'</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">return</span>&nbsp;isset<span class="src-sym">(</span><span class="src-var">$reason</span><span class="src-sym">[</span><span class="src-var">$status</span><span class="src-sym">]</span><span class="src-sym">)</span>?<span class="src-var">$reason</span><span class="src-sym">[</span><span class="src-var">$status</span><span class="src-sym">]</span>:<span class="src-str">''</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">add_header</span><span class="src-sym">(</span><span class="src-var">$key</span><span class="src-sym">,</span><span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">headers</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">]</span>=<span class="src-var">$value</span><span class="src-sym">;</span><span class="src-key">return</span><span class="src-var">$this</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">output</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">status</span><span class="src-sym">))<span class="src-str"></span><span class="src-sym">{</span><span class="src-id">header</span><span class="src-sym">(</span><span class="src-id">sprintf</span><span class="src-sym">(</span><span class="src-str">'HTTP/1.1&nbsp;%d&nbsp;%s'</span><span class="src-sym">,</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">status</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">reason</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-id">TRUE</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">status</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">headers&nbsp;</span><span class="src-key">as</span><span class="src-var">$k</span>=&gt;<span class="src-var">$v</span><span class="src-sym">)<span class="src-str"></span><span class="src-sym">{</span><span class="src-id">header</span><span class="src-sym">(</span><span class="src-str">"</span><span class="src-var">$k</span>:&nbsp;<span class="src-var">$v</span><span class="src-str">"</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span>echo<span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">body</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}}</span><span class="src-key">class</span>&nbsp;<span class="src-id">Trails_Controller</span><span class="src-sym">{</span><span class="src-key">protected</span><span class="src-var">$dispatcher</span><span class="src-sym">,</span><span class="src-var">$response</span><span class="src-sym">,</span><span class="src-var">$performed</span>=<span class="src-id">FALSE</span><span class="src-sym">,</span><span class="src-var">$layout</span><span class="src-sym">;</span><span class="src-key">function</span>&nbsp;<span class="src-id">__construct</span><span class="src-sym">(</span><span class="src-var">$dispatcher</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">dispatcher</span>=<span class="src-var">$dispatcher</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">perform</span><span class="src-sym">(</span><span class="src-var">$unconsumed</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">response</span>=<span class="src-key">new&nbsp;</span><span class="src-id">Trails_Response</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span>list<span class="src-sym">(</span><span class="src-var">$action</span><span class="src-sym">,</span><span class="src-var">$args</span><span class="src-sym">)</span>=<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">extract_action_and_args</span><span class="src-sym">(</span><span class="src-var">$unconsumed</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$before_filter_result</span>=<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">before_filter</span><span class="src-sym">(</span><span class="src-var">$action</span><span class="src-sym">,</span><span class="src-var">$args</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-sym">(</span><span class="src-id">FALSE</span>===<span class="src-var">$before_filter_result</span>||<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">performed</span><span class="src-sym">))<span class="src-str"></span><span class="src-sym">{</span><span class="src-var">$mapped_action</span>=<span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">map_action</span><span class="src-sym">(</span><span class="src-var">$action</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-id">method_exists</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">,</span><span class="src-var">$mapped_action</span><span class="src-sym">))<span class="src-str"></span><span class="src-sym">{</span><span class="src-id">call_user_func_array</span><span class="src-sym">(</span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">&</span><span class="src-var">$this</span><span class="src-sym">,</span><span class="src-var">$mapped_action</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$args</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">else</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">does_not_understand</span><span class="src-sym">(</span><span class="src-var">$action</span><span class="src-sym">,</span><span class="src-var">$args</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">performed</span><span class="src-sym">)<span class="src-str"></span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">render_action</span><span class="src-sym">(</span><span class="src-var">$action</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">after_filter</span><span class="src-sym">(</span><span class="src-var">$action</span><span class="src-sym">,</span><span class="src-var">$args</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">return</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">response</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">extract_action_and_args</span><span class="src-sym">(</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-str">''</span>===<span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">return</span>&nbsp;<span class="src-key">array</span><span class="src-sym">(</span><span class="src-str">'index'</span><span class="src-sym">,</span><span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-var">$args</span>=<span class="src-id">explode</span><span class="src-sym">(</span><span class="src-str">'/'</span><span class="src-sym">,</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$action</span>=<span class="src-id">array_shift</span><span class="src-sym">(</span><span class="src-var">$args</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">return</span>&nbsp;<span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$action</span><span class="src-sym">,</span><span class="src-var">$args</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">map_action</span><span class="src-sym">(</span><span class="src-var">$action</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">return</span><span class="src-var">$action</span>.<span class="src-str">'_action'</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">before_filter</span><span class="src-sym">(</span><span class="src-sym">&</span><span class="src-var">$action</span><span class="src-sym">,</span><span class="src-sym">&</span><span class="src-var">$args</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">after_filter</span><span class="src-sym">(</span><span class="src-var">$action</span><span class="src-sym">,</span><span class="src-var">$args</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">does_not_understand</span><span class="src-sym">(</span><span class="src-var">$action</span><span class="src-sym">,</span><span class="src-var">$args</span><span class="src-sym">)</span><span class="src-sym">{</span>throw&nbsp;<span class="src-key">new</span>&nbsp;<span class="src-id">Trails_Exception</span><span class="src-sym">(</span><span class="src-num">404</span><span class="src-sym">,</span><span class="src-str">'Action&nbsp;missing:&nbsp;'</span>.<span class="src-var">$action</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">redirect</span><span class="src-sym">(</span><span class="src-var">$to</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">performed</span><span class="src-sym">)<span class="src-str"></span><span class="src-sym">{</span>throw&nbsp;<span class="src-key">new</span>&nbsp;<span class="src-id">Trails_Exception</span><span class="src-sym">(</span><span class="src-num">500</span><span class="src-sym">,</span><span class="src-str">'Double&nbsp;Render&nbsp;Error'</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">performed</span>=<span class="src-id">TRUE</span><span class="src-sym">;</span><span class="src-var">$url</span>=<span class="src-id">preg_match</span><span class="src-sym">(</span><span class="src-str">'#^[a-z]+://#'</span><span class="src-sym">,</span><span class="src-var">$to</span><span class="src-sym">)</span>?<span class="src-var">$to</span>:<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">url_for</span><span class="src-sym">(</span><span class="src-var">$to</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">response</span><span class="src-sym">-&gt;</span><span class="src-id">add_header</span><span class="src-sym">(</span><span class="src-str">'Location'</span><span class="src-sym">,</span><span class="src-var">$url</span><span class="src-sym">)</span><span class="src-sym">-&gt;</span><span class="src-id">set_body</span><span class="src-sym">(</span><span class="src-id">sprintf</span><span class="src-sym">(</span><span class="src-str">'&lt;html&gt;&lt;head&gt;&lt;meta&nbsp;http-equiv=&quot;refresh&quot;&nbsp;content=&quot;0;'</span>.<span class="src-str">'url=%s&quot;/&gt;&lt;/head&gt;&lt;/html&gt;'</span><span class="src-sym">,</span><span class="src-id">htmlentities</span><span class="src-sym">(</span><span class="src-var">$url</span><span class="src-sym">)))</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">render_text</span><span class="src-sym">(</span><span class="src-var">$text</span>=<span class="src-str">'&nbsp;'</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">performed</span><span class="src-sym">)<span class="src-str"></span><span class="src-sym">{</span>throw&nbsp;<span class="src-key">new</span>&nbsp;<span class="src-id">Trails_Exception</span><span class="src-sym">(</span><span class="src-num">500</span><span class="src-sym">,</span><span class="src-str">'Double&nbsp;Render&nbsp;Error'</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">performed</span>=<span class="src-id">TRUE</span><span class="src-sym">;</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">response</span><span class="src-sym">-&gt;</span><span class="src-id">set_body</span><span class="src-sym">(</span><span class="src-var">$text</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">render_nothing</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">render_text</span><span class="src-sym">(</span><span class="src-str">''</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">render_action</span><span class="src-sym">(</span><span class="src-var">$action</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$class</span>=<span class="src-id">get_class</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$controller_name</span>=<span class="src-id">Trails_Inflector</span><span class="src-sym">::</span><span class="src-id">underscore</span><span class="src-sym">(</span><span class="src-id">substr</span><span class="src-sym">(</span><span class="src-var">$class</span><span class="src-sym">,</span><span class="src-num">0</span><span class="src-sym">,</span><span class="src-id">strlen</span><span class="src-sym">(</span><span class="src-var">$class</span><span class="src-sym">)</span>-<span class="src-num">10</span><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">render_template</span><span class="src-sym">(</span><span class="src-var">$controller_name</span>.<span class="src-str">'/'</span>.<span class="src-var">$action</span><span class="src-sym">,</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">layout</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">render_template</span><span class="src-sym">(</span><span class="src-var">$template_name</span><span class="src-sym">,</span><span class="src-var">$layout</span>=<span class="src-id">NULL</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$factory</span>=<span class="src-key">new</span>&nbsp;<span class="src-id">Flexi_TemplateFactory</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">dispatcher</span><span class="src-sym">-&gt;</span><span class="src-id">trails_root</span>.<span class="src-str">'/views/'</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$template</span>=<span class="src-var">$factory</span><span class="src-sym">-&gt;</span><span class="src-id">open</span><span class="src-sym">(</span><span class="src-var">$template_name</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-id">is_null</span><span class="src-sym">(</span><span class="src-var">$template</span><span class="src-sym">))<span class="src-str"></span><span class="src-sym">{</span>throw&nbsp;<span class="src-key">new</span>&nbsp;<span class="src-id">Trails_Exception</span><span class="src-sym">(</span><span class="src-num">500</span><span class="src-sym">,</span><span class="src-id">sprintf</span><span class="src-sym">(</span><span class="src-str">'No&nbsp;such&nbsp;template:&nbsp;&quot;%s&quot;'</span><span class="src-sym">,</span><span class="src-var">$template_name</span><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">switch</span><span class="src-sym">(</span><span class="src-id">get_class</span><span class="src-sym">(</span><span class="src-var">$template</span><span class="src-sym">))</span><span class="src-sym">{</span><span class="src-key">case</span><span class="src-str">'Flexi_JsTemplate'</span>:<span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">set_content_type</span><span class="src-sym">(</span><span class="src-str">'text/javascript'</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">break</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-var">$template</span></span><span class="src-sym">-&gt;</span><span class="src-id">set_attributes</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-id">get_assigned_variables</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$layout</span><span class="src-sym">))<span class="src-str"></span><span class="src-sym">{</span><span class="src-var">$template</span></span><span class="src-sym">-&gt;</span><span class="src-id">set_layout</span><span class="src-sym">(</span><span class="src-var">$layout</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">render_text</span><span class="src-sym">(</span><span class="src-var">$template</span><span class="src-sym">-&gt;</span><span class="src-id">render</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">get_assigned_variables</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$assigns</span>=<span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$protected</span>=<span class="src-id">get_class_vars</span><span class="src-sym">(</span><span class="src-id">get_class</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-id">get_object_vars</span><span class="src-sym">(</span><span class="src-var">$this</span><span class="src-sym">)</span><span class="src-key">as</span><span class="src-var">$var</span>=&gt;<span class="src-var">$value</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-id">array_key_exists</span><span class="src-sym">(</span><span class="src-var">$var</span><span class="src-sym">,</span><span class="src-var">$protected</span><span class="src-sym">))</span><span class="src-sym">{</span><span class="src-var">$assigns</span><span class="src-sym">[</span><span class="src-var">$var</span><span class="src-sym">]</span>=<span class="src-sym">&</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">$var</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}}</span><span class="src-var">$assigns</span><span class="src-sym">[</span><span class="src-str">'controller'</span><span class="src-sym">]</span>=<span class="src-var">$this</span><span class="src-sym">;</span><span class="src-key">return</span><span class="src-var">$assigns</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">set_layout</span><span class="src-sym">(</span><span class="src-var">$layout</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">layout</span>=<span class="src-var">$layout</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">url_for</span><span class="src-sym">(</span><span class="src-var">$to</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">return</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">dispatcher</span><span class="src-sym">-&gt;</span><span class="src-id">trails_uri</span>.<span class="src-str">'/'</span>.<span class="src-var">$to</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">set_status</span><span class="src-sym">(</span><span class="src-var">$status</span><span class="src-sym">,</span><span class="src-var">$reason_phrase</span>=<span class="src-id">NULL</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">response</span><span class="src-sym">-&gt;</span><span class="src-id">set_status</span><span class="src-sym">(</span><span class="src-var">$status</span><span class="src-sym">,</span><span class="src-var">$reason_phrase</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">set_content_type</span><span class="src-sym">(</span><span class="src-var">$type</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">response</span><span class="src-sym">-&gt;</span><span class="src-id">add_header</span><span class="src-sym">(</span><span class="src-str">'Content-Type'</span><span class="src-sym">,</span><span class="src-var">$type</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}}</span><span class="src-key">class</span>&nbsp;<span class="src-id">Trails_Inflector</span><span class="src-sym">{</span><span class="src-key">static</span>&nbsp;<span class="src-key">function</span>&nbsp;<span class="src-id">camelize</span><span class="src-sym">(</span><span class="src-var">$word</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$parts</span>=<span class="src-id">explode</span><span class="src-sym">(</span><span class="src-str">'/'</span><span class="src-sym">,</span><span class="src-var">$word</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$parts</span>&nbsp;<span class="src-key">as</span><span class="src-var">$key</span>=&gt;<span class="src-var">$part</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$parts</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">]</span>=<span class="src-id">str_replace</span><span class="src-sym">(</span><span class="src-str">'&nbsp;'</span><span class="src-sym">,</span><span class="src-str">''</span><span class="src-sym">,</span><span class="src-id">ucwords</span><span class="src-sym">(</span><span class="src-id">str_replace</span><span class="src-sym">(</span><span class="src-str">'_'</span><span class="src-sym">,</span><span class="src-str">'&nbsp;'</span><span class="src-sym">,</span><span class="src-var">$part</span><span class="src-sym">)))</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">return</span>&nbsp;<span class="src-id">join</span><span class="src-sym">(</span><span class="src-str">'_'</span><span class="src-sym">,</span><span class="src-var">$parts</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">static</span>&nbsp;<span class="src-key">function</span>&nbsp;<span class="src-id">underscore</span><span class="src-sym">(</span><span class="src-var">$word</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$parts</span>=<span class="src-id">explode</span><span class="src-sym">(</span><span class="src-str">'_'</span><span class="src-sym">,</span><span class="src-var">$word</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$parts</span>&nbsp;<span class="src-key">as</span><span class="src-var">$key</span>=&gt;<span class="src-var">$part</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$parts</span><span class="src-sym">[</span><span class="src-var">$key</span><span class="src-sym">]</span>=<span class="src-id">preg_replace</span><span class="src-sym">(</span><span class="src-str">'/(?&lt;=\w)([A-Z])/'</span><span class="src-sym">,</span><span class="src-str">'_\\1'</span><span class="src-sym">,</span><span class="src-var">$part</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">return</span>&nbsp;<span class="src-id">strtolower</span><span class="src-sym">(</span><span class="src-id">join</span><span class="src-sym">(</span><span class="src-str">'/'</span><span class="src-sym">,</span><span class="src-var">$parts</span><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-sym">}}</span><span class="src-key">class</span>&nbsp;<span class="src-id">Trails_Flash</span><span class="src-sym">{</span><span class="src-key">private</span><span class="src-var">$flash</span><span class="src-sym">,</span><span class="src-var">$used</span><span class="src-sym">;</span><span class="src-key">private</span>&nbsp;<span class="src-key">function</span>&nbsp;<span class="src-id">__construct</span><span class="src-sym">(</span><span class="src-var">$flash</span>=<span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">,</span><span class="src-var">$used</span>=<span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">flash</span>=<span class="src-var">$flash</span><span class="src-sym">;</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">used</span>=<span class="src-var">$used</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">static</span>&nbsp;<span class="src-key">function</span><span class="src-sym">&</span><span class="src-id">flash</span><span class="src-sym">(</span><span class="src-var">$set</span>=<span class="src-id">FALSE</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">static</span><span class="src-var">$flash</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$set</span>!==<span class="src-id">FALSE</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$flash</span>=<span class="src-var">$set</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">return</span><span class="src-var">$flash</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">private</span>&nbsp;<span class="src-key">function</span>&nbsp;<span class="src-id">_use</span><span class="src-sym">(</span><span class="src-var">$k</span>=<span class="src-id">NULL</span><span class="src-sym">,</span><span class="src-var">$v</span>=<span class="src-id">TRUE</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">used</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span>=<span class="src-var">$v</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">else</span><span class="src-sym">{</span><span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">used&nbsp;</span><span class="src-key">as</span><span class="src-var">$k</span>=&gt;<span class="src-var">$value</span><span class="src-sym">)<span class="src-str"></span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">_use</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">,</span><span class="src-var">$v</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}}}</span><span class="src-key">function</span>&nbsp;<span class="src-id">discard</span><span class="src-sym">(</span><span class="src-var">$k</span>=<span class="src-id">NULL</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">_use</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">static</span>&nbsp;<span class="src-key">function</span>&nbsp;<span class="src-id">fire</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$_SESSION</span><span class="src-sym">[</span><span class="src-str">'trails_flash'</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">{</span><span class="src-var">$flash</span>=<span class="src-sym">&</span><span class="src-id">Trails_Flash</span><span class="src-sym">::</span><span class="src-id">flash</span><span class="src-sym">(</span><span class="src-key">new</span>&nbsp;<span class="src-id">Trails_Flash</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-var">$_SESSION</span><span class="src-sym">[</span><span class="src-str">'trails_flash'</span><span class="src-sym">]</span>=<span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$flash</span></span><span class="src-sym">-&gt;</span><span class="src-id">flash</span><span class="src-sym">,</span><span class="src-var">$flash</span><span class="src-sym">-&gt;</span><span class="src-id">used</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">else</span><span class="src-sym">{</span>list<span class="src-sym">(</span><span class="src-var">$_flash</span><span class="src-sym">,</span><span class="src-var">$_used</span><span class="src-sym">)</span>=<span class="src-var">$_SESSION</span><span class="src-sym">[</span><span class="src-str">'trails_flash'</span><span class="src-sym">]</span><span class="src-sym">;</span><span class="src-var">$flash</span>=<span class="src-sym">&</span><span class="src-id">Trails_Flash</span><span class="src-sym">::</span><span class="src-id">flash</span><span class="src-sym">(</span><span class="src-key">new</span>&nbsp;<span class="src-id">Trails_Flash</span><span class="src-sym">(</span><span class="src-var">$_flash</span><span class="src-sym">,</span><span class="src-var">$_used</span><span class="src-sym">))</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-var">$flash</span></span><span class="src-sym">-&gt;</span><span class="src-id">discard</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span><span class="src-sym">&</span><span class="src-id">get</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$return</span>=<span class="src-id">NULL</span><span class="src-sym">;</span><span class="src-key">if</span><span class="src-sym">(</span>isset<span class="src-sym">(</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">flash</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span><span class="src-sym">))<span class="src-str"></span><span class="src-sym">{</span><span class="src-var">$return</span>=<span class="src-sym">&</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">flash</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">return</span><span class="src-var">$return</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">keep</span><span class="src-sym">(</span><span class="src-var">$k</span>=<span class="src-id">NULL</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">_use</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">,</span><span class="src-id">FALSE</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">now</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">,</span><span class="src-var">$v</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">discard</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">flash</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span>=<span class="src-var">$v</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">set</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">,</span><span class="src-var">$v</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">keep</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">flash</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span>=<span class="src-var">$v</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">set_ref</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">,</span><span class="src-sym">&</span><span class="src-var">$v</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-id">keep</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">flash</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span>=<span class="src-sym">&amp;</span><span class="src-var">$v</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">sweep</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span>isset<span class="src-sym">(</span><span class="src-var">$_SESSION</span><span class="src-sym">[</span><span class="src-str">'trails_flash'</span><span class="src-sym">]</span><span class="src-sym">))</span><span class="src-sym">{</span><span class="src-key">return</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-var">$flash</span>=<span class="src-sym">&</span><span class="src-id">Trails_Flash</span><span class="src-sym">::</span><span class="src-id">flash</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$keys</span>=<span class="src-id">array_keys</span><span class="src-sym">(</span><span class="src-var">$flash</span></span><span class="src-sym">-&gt;</span><span class="src-id">flash</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-var">$keys&nbsp;</span><span class="src-key">as</span><span class="src-var">$k</span><span class="src-sym">)<span class="src-str"></span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-var">$flash</span></span><span class="src-sym">-&gt;</span><span class="src-id">used</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span><span class="src-sym">)<span class="src-str"></span><span class="src-sym">{</span><span class="src-var">$flash</span></span><span class="src-sym">-&gt;</span><span class="src-id">_use</span><span class="src-sym">(</span><span class="src-var">$k</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">else</span><span class="src-sym">{</span>unset<span class="src-sym">(</span><span class="src-var">$flash</span></span><span class="src-sym">-&gt;</span><span class="src-id">flash</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span><span class="src-sym">,</span><span class="src-var">$flash</span><span class="src-sym">-&gt;</span><span class="src-id">used</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}}</span><span class="src-var">$fkeys</span>=<span class="src-id">array_keys</span><span class="src-sym">(</span><span class="src-var">$flash</span></span><span class="src-sym">-&gt;</span><span class="src-id">flash</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$ukeys</span>=<span class="src-id">array_keys</span><span class="src-sym">(</span><span class="src-var">$flash</span><span class="src-sym">-&gt;</span><span class="src-id">used</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-key">foreach</span><span class="src-sym">(</span><span class="src-id">array_diff</span><span class="src-sym">(</span><span class="src-var">$fkeys</span><span class="src-sym">,</span><span class="src-var">$ukeys</span><span class="src-sym">)</span><span class="src-key">as</span><span class="src-var">$k</span>=&gt;<span class="src-var">$v</span><span class="src-sym">)<span class="src-str"></span><span class="src-sym">{</span>unset<span class="src-sym">(</span><span class="src-var">$flash</span></span><span class="src-sym">-&gt;</span><span class="src-id">used</span><span class="src-sym">[</span><span class="src-var">$k</span><span class="src-sym">]</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-var">$_SESSION</span><span class="src-sym">[</span><span class="src-str">'trails_flash'</span><span class="src-sym">]</span>=<span class="src-key">array</span><span class="src-sym">(</span><span class="src-var">$flash</span></span><span class="src-sym">-&gt;</span><span class="src-id">flash</span><span class="src-sym">,</span><span class="src-var">$flash</span><span class="src-sym">-&gt;</span><span class="src-id">used</span><span class="src-sym">)</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}}</span><span class="src-key">class</span>&nbsp;<span class="src-id">Trails_Exception</span>&nbsp;<span class="src-key">extends</span>&nbsp;<span class="src-id">Exception</span><span class="src-sym">{</span><span class="src-key">public</span><span class="src-var">$headers</span><span class="src-sym">;</span><span class="src-key">function</span>&nbsp;<span class="src-id">__construct</span><span class="src-sym">(</span><span class="src-var">$status</span><span class="src-sym">,</span><span class="src-var">$reason</span>=<span class="src-id">NULL</span><span class="src-sym">,</span><span class="src-var">$headers</span>=<span class="src-key">array</span><span class="src-sym">(</span><span class="src-sym">))</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$reason</span>===<span class="src-id">NULL</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-var">$reason</span>=<span class="src-id">Trails_Response</span><span class="src-sym">::</span><span class="src-id">get_reason</span><span class="src-sym">(</span><span class="src-var">$status</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-id">parent</span><span class="src-sym">::</span><span class="src-id">__construct</span><span class="src-sym">(</span><span class="src-var">$reason</span><span class="src-sym">,</span><span class="src-var">$status</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$this</span></span><span class="src-sym">-&gt;</span><span class="src-var">headers</span>=<span class="src-var">$headers</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}</span><span class="src-key">function</span>&nbsp;<span class="src-id">__toString</span><span class="src-sym">(</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">return</span><span class="src-str">"</span></span>{<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">code</span><span class="src-sym">}&nbsp;</span>{<span class="src-var">$this</span><span class="src-sym">-&gt;</span><span class="src-var">message</span><span class="src-sym">}<span class="src-str"></span><span class="src-str">"</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">static</span>&nbsp;<span class="src-key">function</span>&nbsp;<span class="src-id">errorHandlerCallback</span><span class="src-sym">(</span><span class="src-var">$errno</span><span class="src-sym">,</span><span class="src-var">$string</span><span class="src-sym">,</span><span class="src-var">$file</span><span class="src-sym">,</span><span class="src-var">$line</span><span class="src-sym">,</span><span class="src-var">$context</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-sym">!</span><span class="src-sym">(</span><span class="src-var">$errno</span><span class="src-sym">&</span><span class="src-id">error_reporting</span><span class="src-sym">(</span><span class="src-sym">)))</span><span class="src-sym">{</span><span class="src-key">return</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-key">if</span><span class="src-sym">(</span><span class="src-var">$errno</span>==<span class="src-id">E_NOTICE</span>||<span class="src-var">$errno</span>==<span class="src-id">E_WARNING</span>||<span class="src-var">$errno</span>==<span class="src-id">E_STRICT</span><span class="src-sym">)</span><span class="src-sym">{</span><span class="src-key">return</span>&nbsp;<span class="src-id">FALSE</span><span class="src-sym">;</span><span class="src-sym">}</span><span class="src-var">$e</span>=<span class="src-key">new</span>&nbsp;<span class="src-id">Trails_Exception</span><span class="src-sym">(</span><span class="src-num">500</span><span class="src-sym">,</span><span class="src-var">$string</span><span class="src-sym">)</span><span class="src-sym">;</span><span class="src-var">$e</span></span><span class="src-sym">-&gt;</span><span class="src-id">line</span>=<span class="src-var">$line</span><span class="src-sym">;</span><span class="src-var">$e</span><span class="src-sym">-&gt;</span><span class="src-id">file</span>=<span class="src-var">$file</span><span class="src-sym">;</span>throw<span class="src-var">$e</span><span class="src-sym">;<span class="src-str"></span><span class="src-sym">}}</span></span></div></li>
</ol>
</div>
        <div class="credit">
		    <hr />
		    Documentation generated on Thu, 08 Jan 2009 13:25:03 +0100 by <a href="http://www.phpdoc.org">phpDocumentor 1.4.2</a>
	      </div>
      </td></tr></table>
    </td>
  </tr>
</table>

</body>
</html>